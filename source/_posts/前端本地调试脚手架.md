---
title: 前端本地调试脚手架
date: 2025-10-22 09:33:58
tags: 脚手架
categories: 工程化
---

# 1、为什么每次npm install -g @vue/cli 会在本地存在一个vue的指令？
通过npm下载的插件，会查看其package。json。如果有bin配置则在本地的node版本下的bin中生成一个快捷方式，软连接到lib下的对应文件。
对应文件中的首行，决定使用那个编译器。
```
#!/usr/bin/env node
```
这个代码的作用是，制定在环境变量中查找node，以node执行对应文件。
# 2、运行本地vue命令会调用逻辑
在终端输入vue命令后，终端会到对应的bin目录下查找对应的命令。没有则返回command not support。有则执行该命令的软链接指向的lib下node_modules下的对应的文件。

# 3、npm如何发布
npm首先npm login，登录到对应账户。通过npm publish，可发布本地包到npm中
注意：
1、包名要唯一，当已存在包名发布时会报没有权限。package.json的name为包名，version版本号也不能与之前发布的一致。

2、npm的registry要是npm不能是 cnpm，npmmirror的。
```
查看注册的npm地址
npm config get registry
重新设置npm地址
npm config set registry https://registry.npmjs.org/
```

# 4、本地调试脚手架的方法
编写脚手架时，依赖包如果都是依赖已发布的，每次有修改都需要重新发布，在删除依赖包后重新安装。这不现实
本地调试好后再发布，
```
cd gk-test-libr
npm link
cd gk-test-cli
npm link gk-test-libr
```
解除链接
```
cd gk-test-cli
npm unlink gk-test-libr
cd gk-test-libr
npm uninstall -g gk-test-libr
```
当解除链接后，需要安装网上版本时，
```
rm -rf node_modules
npm install
```
# 总结
本地调试脚手架的方法核心就是软链接技术 ln -s 源文件或目录的路径 目标软链接的路径，引导本地查找对应的依赖包。
