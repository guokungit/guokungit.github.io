---
title: 每天一个新问题（永远保持怀疑）
date: 2022-05-22 22:49:29
tag: 持续更新（ing）
categories: 前端
---
1、\<\> 、\<React.Fragment\>与\<div\>。前两者作为代码块插入的form表单中，form表单无法获取其值，后者可以获得。
    
######     答案：
```jsx
// form表单获取值是通过内部最近的控件的onchange（）事件和value值获取，<> 和 <React.Fragment>中是没有onchange（）和value事件的，所以form.item无法获取内部控件的值，（对children进行最近的控件的onchange的事件监听）。而div控件是有onchange事件的。（onchage事件是冒泡）
    <Form.Item name="opterator" label="操作人：">
                <div  onChange={e=>{
                  console.log("gerd => " ,e)
                }}>
                <>
                <div onChange={e=>{
                  console.log(e);
                  e.stopPropagation(); //阻止冒泡后，获取不到值
                }}>
                  <input
                    // style={{ width: '75%' }}
                    placeholder="请输入操作人"
                  />
                </div>
              </>
             </div>
        </Form.Item>
```
    
 
2、antd的select的默认属性值在form表单中不起作用，获取的是undefined
    
  ######     答案
  >form表单中控件的值默认初始化只能通过form的initialValues和setFieldsValue进行初始化，form.item内部控件中的defaultvalue值只能展示，但是当获取时，通过form的value为undefined。
>

3、this.setstate({data}),为了代码的简略性，常常使用es6的特性。易出现state值发生了变化，但是render函数并未触发。
    
######     解答
    
>react的this.setstate方法在对象引用是需要注意，当对象中属性发生变化时，对象引用即发生变化，当数组对象中成员添加时，引用未发生变化。建议通过this.setstate({data: [...data]})的方式，将数组拆分赋值，实现引用的变化来触发render函数。
>

4、 当我们开发时，经常遇到antd中日期选择器的时间处理。
    
######     解答
```js
// 通过monent函数转化，当然，monent需要引入函数库；import monent from 'monent';
startDate = moment(value.findDate[0].format('YYYY-MM-DD HH:mm:ss'));// 转化为开始日期
endDate = moment(value.findDate[1].format('YYYY-MM-DD HH:mm:ss'));// 转化为结束日期
// 此处的x为datepicker的value值哟。
日期=》时间戳： x.unix()
时间戳=》日期：moment( new Date(x * 1000 ))
```
    
5、当需要实现带状态跳转页面时，实现进出返回页面的页面信息一致。
    
###### 郭坤、史壮壮、徐雯等在林静第一次线下沟通时的讨论所得。
>1）、redux
>2）、将状态放在上级组件中存储 
>3）、放在sessionstorage或localstorage中存储
>

优缺点：redux可避免状态外漏
    

| 序号 | 方法 |优点  | 缺点 |
| --- | --- | --- | --- |
|1  | redux | 避免状态信息的泄漏 | 每次不可以刷新页面进入，需通过路由跳转才能获取props中redux的值 |
| 2 |将状态放在上级组件中存储  |  通过组件的props传值，获取值时机可靠|  组件间耦合关系太深，开发繁琐 |
| 3 |放在sessionstorage或localstorage中存储  |  存储值方便|当页面跳转时，无法有效的删除storage和在session中泄露状态信息  |
|4|放在url中存储 |方便页面跳转获取参数  |  当状态信息过多时，超出url长度。对于泄漏参数信息可以通过加密实现，最简单的window.btoa()和window.atob();window.atob()进行加密|

```
6、<a href="#"></a>标签点击下，路由上会添加#，当有涉及到路由情况时要注意，比如umi的propmt控件，检测路由变化，当路由发生变化时才进入肉流程。反之不会。
    <Prompt
      when={this.state.submit} // sunmit为提交按钮状态 默认为false
      message={location => {
        if (this.state.submit) {
          Modal.confirm({
            icon: <ExclamationCircleOutlined />,
            content: '暂未提交您所做的更改，是否提交',
            okText: '继续加载',
            cancelText: '取消',
            onOk: () => {
              this.setState({ submit: false }, () => {
                this.props.history.push(`${location.pathname}`);
              });
            },
            onCancel: () => {},
          });
          return false; // 返回false时，阻塞路由跳转
        }
        return true; // 返回true时，路由跳转
      }}
```
7、永远不要修改this.state里的对象，要用lodash的cloneDeep实现对象隔离。chrome也是人写的，不可避免的存在错误，不要相信没问题的工具。能相信的只有自己。！！！！
 
8、父组件向子组件传值，子组件的个别属性接收的是第一次组件的值。状态未刷新
######     解答
        react的diff是根据组件的key值和value进行对比是否进行更换的，没有key值易出现传a但是接受到的还是b，状态没有刷新的情况。
 9、定位问题，需要根据现有的情况进行定位。比如：当页面上路由展示不对时，应该尝试当url变化时，内容是否展示。是则是展示控件问题，通过查看版本锁，打包工具的不同对应的版本锁也不同。
 10、验签问题，验签实质时获取申请的资源通过计算出想要的字段放在头文件中，每次调用接口都带上。
######         坑
       当设计时间戳问题时，一般设置为前后三十秒。且为本机时间，这时候电脑时间要与网络同步，不然会验签不通过。
11、antd的版本包问题：antdesign/proprolayout依赖安装ant时，它默认安装最新的antd版本包。但是antd的版本包易出错，导致网站样式错误。
######         解答
        通过指定安装antd版本，寻找无问题的antd版本可以安装无错误时间的antd版本，或者，依赖安装的prolayout中指定的antd版本。（到npm包仓库中找对应的版本包里的依赖项的版本）